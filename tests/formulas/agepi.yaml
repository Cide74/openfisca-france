- name: Test 01 - Vérifie l'éligibilité à l'AGEPI pour une famille avec 1 enfant éligible
  period: 2022-01
  input:
    menage:
      personne_de_reference: Camille
      enfants: [Jean, Marie]
      residence_mayotte: False
    individus:
      Camille:
        age: 29
        agepi_percue_12_derniers_mois: False
        pole_emploi_categorie_demandeur_emploi: categorie_1
        stagiaire: False
        en_contrat_aide: False
        lieu_emploi_ou_formation: metropole
        contrat_de_travail_debut: '2021-01-01'
        agepi_date_demande: '2021-01-02'
        allocation_retour_emploi: 0
        contrat_de_travail_type: cdd
        contrat_de_travail_duree: 3
        types_intensite_activite: hebdomadaire
        agepi_temps_travail_en_heure: 10
      Jean:
        age: 12
      Marie:
        age: 8
    familles:
      famille1:
        parents: Camille
        enfants: [Jean, Marie]
    foyer_fiscal:
      declarants: Camille
      personnes_a_charge: [Jean, Marie]
  output:
    agepi_eligible: [True, False, False]
    agepi_nbenf: 1
    agepi: [170, 0, 0]


- name: Test 02 - Vérifie si l'individu élève seul son enfant dont l'age est inférieur à 10 ans
  period: 2022-01
  input:
    menage:
      personne_de_reference: Camille
      conjoint: Paul
      enfants: [Jean, Marie]
      residence_mayotte: False
    individus:
      Camille:
        age: 29
        agepi_percue_12_derniers_mois: False
        pole_emploi_categorie_demandeur_emploi: categorie_1
        stagiaire: False
        en_contrat_aide: False
        lieu_emploi_ou_formation: metropole
        contrat_de_travail_debut: '2021-01-01'
        agepi_date_demande: '2021-01-02'
        allocation_retour_emploi: 0
        contrat_de_travail_type: cdd
        contrat_de_travail_duree: 3
        types_intensite_activite: hebdomadaire
        agepi_temps_travail_en_heure: 10
      Paul:
        age: 30
      Jean:
        age: 12
      Marie:
        age: 8
    familles:
      famille1:
        parents: [Camille, Paul]
        enfants: [Jean, Marie]
    foyer_fiscal:
      declarants: [Camille, Paul]
      personnes_a_charge: [Jean, Marie]
  output:
    agepi_eligible: [False, False, False, False]
    agepi_nbenf: 1
    agepi: [0, 0, 0, 0]


- name: Test 03 - Vérifie le non cumul de l'aide AGEPI
  period: 2022-01
  input:
    menage:
      personne_de_reference: Camille
      enfants: [Jean, Marie]
      residence_mayotte: False
    individus:
      Camille:
        age: 29
        agepi_percue_12_derniers_mois: True
        pole_emploi_categorie_demandeur_emploi: categorie_1
        stagiaire: False
        en_contrat_aide: False
        lieu_emploi_ou_formation: metropole
        contrat_de_travail_debut: '2021-01-01'
        agepi_date_demande: '2021-01-02'
        allocation_retour_emploi: 0
        contrat_de_travail_type: cdd
        contrat_de_travail_duree: 3
        types_intensite_activite: hebdomadaire
        agepi_temps_travail_en_heure: 10
      Jean:
        age: 12
      Marie:
        age: 8
    familles:
      famille1:
        parents: Camille
        enfants: [Jean, Marie]
    foyer_fiscal:
      declarants: Camille
      personnes_a_charge: [Jean, Marie]
  output:
    agepi_eligible: [False, False, False]
    agepi_nbenf: 1
    agepi: [0, 0, 0]


- name: Test 04 - Vérifie si l'individu appartient à une catégorie éligible à l'AGEPI
  period: 2022-01
  input:
    menage:
      personne_de_reference: Camille
      enfants: [Jean, Marie]
      residence_mayotte: False
    individus:
      Camille:
        age: 29
        agepi_percue_12_derniers_mois: True
        pole_emploi_categorie_demandeur_emploi: categorie_6
        stagiaire: False
        en_contrat_aide: False
        lieu_emploi_ou_formation: metropole
        contrat_de_travail_debut: '2021-01-01'
        agepi_date_demande: '2021-01-02'
        allocation_retour_emploi: 0
        contrat_de_travail_type: cdd
        contrat_de_travail_duree: 3
        types_intensite_activite: hebdomadaire
        agepi_temps_travail_en_heure: 10
      Jean:
        age: 12
      Marie:
        age: 8
    familles:
      famille1:
        parents: Camille
        enfants: [Jean, Marie]
    foyer_fiscal:
      declarants: Camille
      personnes_a_charge: [Jean, Marie]
  output:
    agepi_eligible: [False, False, False]
    agepi_nbenf: 1
    agepi: [0, 0, 0]


- name: Test 05 - Vérifie si l'individu est de catégorie 4 et stagiaire de formation professionnelle
  period: 2022-01
  input:
    menage:
      personne_de_reference: Camille
      enfants: [Jean, Marie]
      residence_mayotte: False
    individus:
      Camille:
        age: 29
        agepi_percue_12_derniers_mois: False
        pole_emploi_categorie_demandeur_emploi: categorie_4
        stagiaire: True
        en_contrat_aide: False
        lieu_emploi_ou_formation: metropole
        contrat_de_travail_debut: '2021-01-01'
        agepi_date_demande: '2021-01-02'
        allocation_retour_emploi: 0
        contrat_de_travail_type: cdd
        contrat_de_travail_duree: 3
        types_intensite_activite: hebdomadaire
        agepi_temps_travail_en_heure: 10
      Jean:
        age: 12
      Marie:
        age: 8
    familles:
      famille1:
        parents: Camille
        enfants: [Jean, Marie]
    foyer_fiscal:
      declarants: Camille
      personnes_a_charge: [Jean, Marie]
  output:
    agepi_eligible: [True, False, False]
    agepi_nbenf: 1
    agepi: [170, 0, 0]


- name: Test 06 - Vérifie si l'individu est de catégorie 5 et en contrat aidé
  period: 2022-01
  input:
    menage:
      personne_de_reference: Camille
      enfants: [Jean, Marie]
      residence_mayotte: False
    individus:
      Camille:
        age: 29
        agepi_percue_12_derniers_mois: False
        pole_emploi_categorie_demandeur_emploi: categorie_5
        stagiaire: False
        en_contrat_aide: True
        lieu_emploi_ou_formation: metropole
        contrat_de_travail_debut: '2021-01-01'
        agepi_date_demande: '2021-01-02'
        allocation_retour_emploi: 0
        contrat_de_travail_type: cdd
        contrat_de_travail_duree: 3
        types_intensite_activite: hebdomadaire
        agepi_temps_travail_en_heure: 10
      Jean:
        age: 12
      Marie:
        age: 8
    familles:
      famille1:
        parents: Camille
        enfants: [Jean, Marie]
    foyer_fiscal:
      declarants: Camille
      personnes_a_charge: [Jean, Marie]
  output:
    agepi_eligible: [True, False, False]
    agepi_nbenf: 1
    agepi: [170, 0, 0]


- name: Test 07 - Vérifie si la reprise d'emploi ou de formation a lieu en France
  period: 2022-01
  input:
    menage:
      personne_de_reference: Camille
      enfants: [Jean, Marie]
      residence_mayotte: False
    individus:
      Camille:
        age: 29
        agepi_percue_12_derniers_mois: False
        pole_emploi_categorie_demandeur_emploi: categorie_1
        stagiaire: False
        en_contrat_aide: False
        lieu_emploi_ou_formation: non_renseigne
        contrat_de_travail_debut: '2021-01-01'
        agepi_date_demande: '2021-01-02'
        allocation_retour_emploi: 0
        contrat_de_travail_type: cdd
        contrat_de_travail_duree: 3
        types_intensite_activite: hebdomadaire
        agepi_temps_travail_en_heure: 10
      Jean:
        age: 12
      Marie:
        age: 8
    familles:
      famille1:
        parents: Camille
        enfants: [Jean, Marie]
    foyer_fiscal:
      declarants: Camille
      personnes_a_charge: [Jean, Marie]
  output:
    agepi_eligible: [False, False, False]
    agepi_nbenf: 1
    agepi: [0, 0, 0]


- name: Test 08 - Vérifie si l'individu a effectué sa demande au plus tard dans le mois qui suit sa reprise d'emploi ou de formation
  period: 2022-01
  input:
    menage:
      personne_de_reference: Camille
      enfants: [Jean, Marie]
      residence_mayotte: False
    individus:
      Camille:
        age: 29
        agepi_percue_12_derniers_mois: False
        pole_emploi_categorie_demandeur_emploi: categorie_1
        stagiaire: False
        en_contrat_aide: False
        lieu_emploi_ou_formation: metropole
        contrat_de_travail_debut: '2021-01-01'
        agepi_date_demande: '2021-02-02'
        allocation_retour_emploi: 0
        contrat_de_travail_type: cdd
        contrat_de_travail_duree: 3
        types_intensite_activite: hebdomadaire
        agepi_temps_travail_en_heure: 10
      Jean:
        age: 12
      Marie:
        age: 8
    familles:
      famille1:
        parents: Camille
        enfants: [Jean, Marie]
    foyer_fiscal:
      declarants: Camille
      personnes_a_charge: [Jean, Marie]
  output:
    agepi_eligible: [False, False, False]
    agepi_nbenf: 1
    agepi: [0, 0, 0]


- name: Test 09 - Vérifie si l'individu élève seul son enfant dont l'age est inférieur à 10 ans
  period: 2022-01
  input:
    menages:
      menage_1:
        personne_de_reference: Camille
        enfants: [Jean, Marie]
        residence_mayotte: False
      menage_2:
        personne_de_reference: Paul
        conjoint: Elodie
        enfants: [Aileen, Sebastien]
    individus:
      Camille:
        age: 29
        agepi_percue_12_derniers_mois: False
        pole_emploi_categorie_demandeur_emploi: categorie_1
        stagiaire: False
        en_contrat_aide: False
        lieu_emploi_ou_formation: metropole
        contrat_de_travail_debut: '2021-01-01'
        agepi_date_demande: '2021-01-02'
        allocation_retour_emploi: 0
        contrat_de_travail_type: cdd
        contrat_de_travail_duree: 3
        types_intensite_activite: hebdomadaire
        agepi_temps_travail_en_heure: 10
      Jean:
        age: 12
      Marie:
        age: 8
      Elodie:
        age: 31
      Paul:
        age: 30
      Aileen:
        age: 9
      Sebastien:
        age: 7
    familles:
      famille_1:
        parents: Camille
        enfants: [Jean, Marie]
      famille_2:
        parents: [Elodie, Paul]
        enfants: [Aileen, Sebastien]
    foyers_fiscaux:
      foyer_fiscal_1:
        declarants: Camille
        personnes_a_charge: [Jean, Marie]
      foyer_fiscal_2:
        declarants: [Elodie, Paul]
        personnes_a_charge: [Aileen, Sebastien]
  output:
    agepi_eligible: [True, False, False, False, False, False, False]
    agepi_nbenf: [1, 2]
    agepi: [170, 0, 0, 0, 0, 0, 0 ]


- name: Test 10 - Individu eligible, 1 enfant, reprise CDD < 64h/mois, hors Mayotte
  period: 2022-01
  input:
    menage:
      personne_de_reference: Camille
      enfants: [Jean, Marie]
      residence_mayotte: False
    individus:
      Camille:
        age: 29
        agepi_percue_12_derniers_mois: False
        pole_emploi_categorie_demandeur_emploi: categorie_1
        stagiaire: False
        en_contrat_aide: False
        lieu_emploi_ou_formation: metropole
        contrat_de_travail_debut: '2021-01-01'
        agepi_date_demande: '2021-01-02'
        allocation_retour_emploi: 0
        contrat_de_travail_type: cdd
        contrat_de_travail_duree: 3
        types_intensite_activite: mensuelle
        agepi_temps_travail_en_heure: 63
      Jean:
        age: 12
      Marie:
        age: 8
    familles:
      famille1:
        parents: Camille
        enfants: [Jean, Marie]
    foyer_fiscal:
      declarants: Camille
      personnes_a_charge: [Jean, Marie]
  output:
    agepi_eligible: [True, False, False]
    agepi_nbenf: 1
    agepi: [170, 0, 0]


- name: Test 11 - Individu eligible 2 enfants, reprise CDD >= 64h/mois, hors Mayotte
  period: 2022-01
  input:
    menage:
      personne_de_reference: Camille
      enfants: [Jean, Marie]
      residence_mayotte: False
    individus:
      Camille:
        age: 29
        agepi_percue_12_derniers_mois: False
        pole_emploi_categorie_demandeur_emploi: categorie_1
        stagiaire: False
        en_contrat_aide: False
        lieu_emploi_ou_formation: metropole
        contrat_de_travail_debut: '2021-01-01'
        agepi_date_demande: '2021-01-02'
        allocation_retour_emploi: 0
        contrat_de_travail_type: cdd
        contrat_de_travail_duree: 3
        types_intensite_activite: mensuelle
        agepi_temps_travail_en_heure: 64
      Jean:
        age: 9
      Marie:
        age: 8
    familles:
      famille1:
        parents: Camille
        enfants: [Jean, Marie]
    foyer_fiscal:
      declarants: Camille
      personnes_a_charge: [Jean, Marie]
  output:
    agepi_eligible: [True, False, False]
    agepi_nbenf: 2
    agepi: [460, 0, 0]


- name: Test 12 - Individu eligible 2 enfants, reprise CDD >= 64h/mois, Mayotte
  period: 2022-01
  input:
    menage:
      personne_de_reference: Camille
      enfants: [Jean, Marie]
      residence_mayotte: True
    individus:
      Camille:
        age: 29
        agepi_percue_12_derniers_mois: False
        pole_emploi_categorie_demandeur_emploi: categorie_1
        stagiaire: False
        en_contrat_aide: False
        lieu_emploi_ou_formation: metropole
        contrat_de_travail_debut: '2021-01-01'
        agepi_date_demande: '2021-01-02'
        allocation_retour_emploi: 0
        contrat_de_travail_type: cdd
        contrat_de_travail_duree: 3
        types_intensite_activite: mensuelle
        agepi_temps_travail_en_heure: 64
      Jean:
        age: 9
      Marie:
        age: 8
    familles:
      famille1:
        parents: Camille
        enfants: [Jean, Marie]
    foyer_fiscal:
      declarants: Camille
      personnes_a_charge: [Jean, Marie]
  output:
    agepi_eligible: [True, False, False]
    agepi_nbenf: 2
    agepi: [230, 0, 0]


- name: Test 13 - Individu eligible 2 enfants, reprise formation >= 40h, catégorie 4, Mayotte
  period: 2022-01
  input:
    menage:
      personne_de_reference: Camille
      enfants: [Jean, Marie]
      residence_mayotte: True
    individus:
      Camille:
        age: 29
        agepi_percue_12_derniers_mois: False
        pole_emploi_categorie_demandeur_emploi: categorie_4
        stagiaire: True
        en_contrat_aide: False
        lieu_emploi_ou_formation: metropole
        contrat_de_travail_debut: '2021-01-01'
        agepi_date_demande: '2021-01-02'
        allocation_retour_emploi: 0
        contrat_de_travail_type: formation
        duree_formation: 40
        contrat_de_travail_duree: 0
        types_intensite_activite: mensuelle
        agepi_temps_travail_en_heure: 40
      Jean:
        age: 9
      Marie:
        age: 8
    familles:
      famille1:
        parents: Camille
        enfants: [Jean, Marie]
    foyer_fiscal:
      declarants: Camille
      personnes_a_charge: [Jean, Marie]
  output:
    agepi_eligible: [True, False, False]
    agepi_nbenf: 2
    agepi: [97.5, 0, 0]


- name: Test 14 - Individu eligible, 1 enfant, reprise CDI, hors Mayotte
  period: 2022-01
  input:
    menage:
      personne_de_reference: Camille
      enfants: [Jean, Marie]
      residence_mayotte: False
    individus:
      Camille:
        age: 29
        agepi_percue_12_derniers_mois: False
        pole_emploi_categorie_demandeur_emploi: categorie_1
        stagiaire: False
        en_contrat_aide: False
        lieu_emploi_ou_formation: metropole
        contrat_de_travail_debut: '2021-01-01'
        agepi_date_demande: '2021-01-02'
        allocation_retour_emploi: 0
        contrat_de_travail_type: cdi
        contrat_de_travail_duree: 0
        types_intensite_activite: hebdomadaire
        agepi_temps_travail_en_heure: 15
      Jean:
        age: 12
      Marie:
        age: 8
    familles:
      famille1:
        parents: Camille
        enfants: [Jean, Marie]
    foyer_fiscal:
      declarants: Camille
      personnes_a_charge: [Jean, Marie]
  output:
    agepi_eligible: [True, False, False]
    agepi_nbenf: 1
    agepi: [400, 0, 0]


- name: Test 15 - Individu eligible, 1 enfant, reprise CDI, Mayotte, ressource < ARE Min Mayotte
  period: 2022-01
  input:
    menage:
      personne_de_reference: Camille
      enfants: [Jean, Marie]
      residence_mayotte: True
    individus:
      Camille:
        age: 29
        agepi_percue_12_derniers_mois: False
        pole_emploi_categorie_demandeur_emploi: categorie_1
        stagiaire: False
        en_contrat_aide: False
        lieu_emploi_ou_formation: metropole
        contrat_de_travail_debut: '2021-01-01'
        agepi_date_demande: '2021-01-02'
        allocation_retour_emploi: 14.77
        contrat_de_travail_type: cdi
        contrat_de_travail_duree: 0
        types_intensite_activite: hebdomadaire
        agepi_temps_travail_en_heure: 8
      Jean:
        age: 12
      Marie:
        age: 8
    familles:
      famille1:
        parents: Camille
        enfants: [Jean, Marie]
    foyer_fiscal:
      declarants: Camille
      personnes_a_charge: [Jean, Marie]
  output:
    agepi_eligible: [True, False, False]
    agepi_nbenf: 1
    agepi: [85, 0, 0]
