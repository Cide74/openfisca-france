#  test à faire :
#  pas de prime ok
#  prime minimum de 1 euro ok
#  cas général à 1000 euros ok
#  test à 1001 euros ok
#  test à 2000 e ok
#  test avec accord et pas d'accord
#  test pour employeur salaire super brut
# Test pour 3 fois le smic au dessus et en dessous

- name: Prime exceptionnelle de pouvoir d'achat d'un montant de 1001 euros et un salaire mensuel de 5000 euros
  period: 2021-09
  input:
    categorie_salarie: salarie
    prime_exceptionnelle_pouvoir_achat: 1001
    salaire_de_base:
      2021-01: 5000
      2021-02: 5000
      2021-03: 5000
      2021-04: 5000
      2021-05: 5000
      2021-06: 5000
      2021-07: 5000
      2021-08: 5000
      2021-09: 5000
      2021-10: 5000
      2021-11: 5000
      2021-12: 5000
  output:
    irpp:
      2021: -7741
    salaire_super_brut: 9500.045
    prime_exceptionnelle_pouvoir_achat_exoneree: 0
    prime_exceptionnelle_pouvoir_achat_non_exoneree: 1001
    csg_deductible_salaire: -400.92664
    csg_imposable_salaire: -141.50352
    crds_salaire: -29.4799

- name: Prime exceptionnelle de pouvoir d'achat d'un montant de 1500 euro sans accord d'interessement
  period: 2020-06
  input:
    categorie_salarie: salarie
    prime_exceptionnelle_pouvoir_achat: 1500
    effectif_entreprise: 28
    accord_interessement: false
    salaire_de_base:
      2020-01: 2000
  output:
    irpp:
      2021: 0
    prime_exceptionnelle_pouvoir_achat_exoneree: 1500
    prime_exceptionnelle_pouvoir_achat_non_exoneree: 0
    salaire_super_brut: 1500
    csg_deductible_salaire: 0
    csg_imposable_salaire: 0
    crds_salaire: 0

- name: Prime exceptionnelle de pouvoir d'achat d'un montant de 1 euro
  period: 2021-09
  input:
    categorie_salarie: salarie
    prime_exceptionnelle_pouvoir_achat: 1
    salaire_de_base: 0
  output:
    salaire_super_brut: 1
    prime_exceptionnelle_pouvoir_achat_exoneree: 1
    prime_exceptionnelle_pouvoir_achat_non_exoneree: 0
    csg_deductible_salaire: 0
    csg_imposable_salaire: 0
    crds_salaire: 0

- name: Prime exceptionnelle de pouvoir d'achat au plafond de 1000 euros (cas général)
  period: 2020-05
  input:
    prime_exceptionnelle_pouvoir_achat: 1300
    salaire_de_base: 700
  output:
    prime_exceptionnelle_pouvoir_achat_exoneree: 1300
    prime_exceptionnelle_pouvoir_achat_non_exoneree: 0
    salaire_super_brut: 2290.19
    csg_deductible_salaire: -46.767
    csg_imposable_salaire: -16.506
    crds_salaire: -3.43875

- name: Prime exceptionnelle de pouvoir d'achat au plafond de 2000 euros (cas avec accord d'interessement)
  period: 2021-10
  input:
    categorie_salarie: salarie
    prime_exceptionnelle_pouvoir_achat: 2000
    salaire_de_base: 2000
    effectif_entreprise: 37
    accord_interessement: true
  output:
    # participation_effort_construction : 9 euros à partir de 50 salariés
    salaire_net_a_payer: 1583.1951 + 2000
    crds_salaire: -9.825
    csg_imposable_salaire: -47.16
    csg_deductible_salaire: -133.62
    salaire_super_brut: 2829.12 + 2000 + 9 # la prime n'est pas imposée
    # irpp_economique: 0
    prime_exceptionnelle_pouvoir_achat_exoneree: 2000
    prime_exceptionnelle_pouvoir_achat_non_exoneree: 0

- name: Prime exceptionnelle de pouvoir d'achat au plafond de 2000 euros sans accord d'interessement
  period: 2021-10
  input:
    categorie_salarie: salarie
    salaire_de_base: 2000
    prime_exceptionnelle_pouvoir_achat: 2000
    accord_interessement: false
  output:
    salaire_super_brut: 4829.12
    prime_exceptionnelle_pouvoir_achat: 2000
    prime_exceptionnelle_pouvoir_achat_non_exoneree: 0
    prime_exceptionnelle_pouvoir_achat_exoneree: 2000
    csg_imposable_salaire: -47.16
    csg_deductible_salaire: -133.62
    crds_salaire: -9.825

- name: Prime exceptionnelle de pouvoir d'achat à 3 fois le SMIC euros avec accord d'interessement
  period: 2021-05
  input:
    categorie_salarie: salarie
    salaire_de_base: 8909.35
    prime_exceptionnelle_pouvoir_achat: 2000
    accord_interessement: true
    effectif_entreprise: 50
  output:
    prime_exceptionnelle_pouvoir_achat_non_exoneree: 2000
    prime_exceptionnelle_pouvoir_achat_exoneree: 0
    salaire_super_brut: 17597.398
    csg_imposable_salaire: -257.24255
    csg_deductible_salaire: -728.8539
    crds_salaire: -53.592197
